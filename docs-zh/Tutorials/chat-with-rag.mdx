---
title: åˆ›å»ºå‘é‡ RAG èŠå¤©æœºå™¨äºº
slug: /chat-with-rag
---

import Icon from "@site/src/components/icon";
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

æœ¬æ•™ç¨‹æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Langflow åˆ›å»ºä¸€ä¸ªèŠå¤©æœºå™¨äººåº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨æ£€ç´¢å¢å¼ºç”Ÿæˆ (RAG) å°†æ‚¨çš„æ•°æ®ä½œä¸ºå‘é‡åµŒå…¥åˆ°å‘é‡æ•°æ®åº“ä¸­ï¼Œç„¶åä¸æ•°æ®èŠå¤©ã€‚

## å…ˆå†³æ¡ä»¶

- [æ­£åœ¨è¿è¡Œçš„ Langflow å®ä¾‹](/get-started-installation)
- [Langflow API å¯†é’¥](/configuration-api-keys)
- [OpenAI API å¯†é’¥](https://platform.openai.com/)
- [å·²å®‰è£… Langflow JavaScript å®¢æˆ·ç«¯](/typescript-client)
- ç†Ÿæ‚‰å‘é‡æœç´¢æ¦‚å¿µå’Œåº”ç”¨ï¼Œå¦‚[å‘é‡æ•°æ®åº“](https://www.datastax.com/guides/what-is-a-vector-database)å’Œ [RAG](https://www.datastax.com/guides/what-is-retrieval-augmented-generation)

## åˆ›å»ºå‘é‡ RAG flow

1. åœ¨ Langflow ä¸­ï¼Œç‚¹å‡» **New Flow**ï¼Œç„¶åé€‰æ‹© **Vector Store RAG** æ¨¡æ¿ã€‚

    <details>
    <summary>å…³äº Vector Store RAG æ¨¡æ¿</summary>

    æ­¤æ¨¡æ¿æœ‰ä¸¤ä¸ª flowã€‚

    å·¥ä½œåŒºåº•éƒ¨çš„ **Load Data Flow** ä½¿ç”¨æ–‡ä»¶ä¸­çš„æ•°æ®å¡«å……å‘é‡å­˜å‚¨ã€‚
    æ­¤æ•°æ®ç”¨äºå“åº”æäº¤ç»™ **Retriever Flow** çš„æŸ¥è¯¢ï¼Œåè€…ä½äºå·¥ä½œåŒºçš„é¡¶éƒ¨ã€‚

    å…·ä½“æ¥è¯´ï¼Œ**Load Data Flow** ä»æœ¬åœ°æ–‡ä»¶æ¥æ”¶æ•°æ®ï¼Œå°†æ•°æ®åˆ†å‰²æˆå—ï¼Œåœ¨æ‚¨çš„å‘é‡æ•°æ®åº“ä¸­åŠ è½½å’Œç´¢å¼•æ•°æ®ï¼Œç„¶åä¸ºå—è®¡ç®—åµŒå…¥ã€‚åµŒå…¥ä¹Ÿä¸åŠ è½½çš„æ•°æ®ä¸€èµ·å­˜å‚¨ã€‚æ­¤ flow åªéœ€è¦åœ¨æ‚¨éœ€è¦å°†æ•°æ®åŠ è½½åˆ°å‘é‡æ•°æ®åº“ä¸­æ—¶è¿è¡Œã€‚

    **Retriever Flow** æ¥æ”¶èŠå¤©è¾“å…¥ï¼Œä¸ºè¾“å…¥ç”ŸæˆåµŒå…¥ï¼Œç„¶åä½¿ç”¨å¤šä¸ªç»„ä»¶å°†å—é‡æ„ä¸ºæ–‡æœ¬ï¼Œå¹¶é€šè¿‡å°†æ–°åµŒå…¥ä¸å­˜å‚¨çš„åµŒå…¥è¿›è¡Œæ¯”è¾ƒæ¥æŸ¥æ‰¾ç›¸ä¼¼æ•°æ®ï¼Œä»è€Œç”Ÿæˆå“åº”ã€‚

    </details>

2. å°†æ‚¨çš„ **OpenAI** API å¯†é’¥æ·»åŠ åˆ°ä¸¤ä¸ª **OpenAI Embeddings** ç»„ä»¶ä¸­ã€‚

3. å¯é€‰ï¼šå°†ä¸¤ä¸ª **Astra DB** å‘é‡å­˜å‚¨ç»„ä»¶æ›¿æ¢ä¸º **Chrome DB** æˆ–æ‚¨é€‰æ‹©çš„å…¶ä»–[å‘é‡å­˜å‚¨ç»„ä»¶](/components-vector-stores)ã€‚
æœ¬æ•™ç¨‹ä½¿ç”¨ Chroma DBã€‚

    **Load Data Flow** åº”è¯¥åŒ…å« **File**ã€**Split Text**ã€**Embedding Model**ã€å‘é‡å­˜å‚¨ï¼ˆå¦‚ **Chroma DB**ï¼‰å’Œ **Chat Output** ç»„ä»¶ï¼š

    ![File loader chat flow](/img/tutorial-chatbot-embed-files.png)

    **Retriever Flow** åº”è¯¥åŒ…å« **Chat Input**ã€**Embedding Model**ã€å‘é‡å­˜å‚¨ã€**Parser**ã€**Prompt**ã€**Language Model** å’Œ **Chat Output** ç»„ä»¶ï¼š

    ![Chat with RAG flow](/img/tutorial-chatbot-chat-flow.png)

    flow å·²å‡†å¤‡å°±ç»ªå¯ä»¥ä½¿ç”¨ã€‚
    ç»§ç»­æ•™ç¨‹å­¦ä¹ å¦‚ä½•ä½¿ç”¨åŠ è½½ flow å°†æ•°æ®åŠ è½½åˆ°å‘é‡å­˜å‚¨ä¸­ï¼Œç„¶ååœ¨èŠå¤©æœºå™¨äººåº”ç”¨ç¨‹åºä¸­è°ƒç”¨èŠå¤© flowã€‚

## åŠ è½½æ•°æ®å¹¶ç”ŸæˆåµŒå…¥

è¦åŠ è½½æ•°æ®å¹¶ç”ŸæˆåµŒå…¥ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Langflow UI æˆ– `/v2/files` ç«¯ç‚¹ã€‚

Langflow UI é€‰é¡¹æ›´ç®€å•ï¼Œä½†ä»…å»ºè®®åœ¨åˆ›å»º flow çš„ç”¨æˆ·ä¸å°†æ•°æ®åŠ è½½åˆ°æ•°æ®åº“ä¸­çš„ç”¨æˆ·æ˜¯åŒä¸€ç”¨æˆ·çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚

åœ¨è®¸å¤šç”¨æˆ·åŠ è½½æ•°æ®æˆ–æ‚¨éœ€è¦ä»¥ç¼–ç¨‹æ–¹å¼åŠ è½½æ•°æ®çš„æƒ…å†µä¸‹ï¼Œè¯·ä½¿ç”¨ Langflow API é€‰é¡¹ã€‚

<Tabs>
<TabItem value="UI" label="Langflow UI" default>

1. åœ¨æ‚¨çš„ RAG èŠå¤©æœºå™¨äºº flow ä¸­ï¼Œç‚¹å‡» **File component**ï¼Œç„¶åç‚¹å‡» **File**ã€‚
2. é€‰æ‹©æ‚¨è¦ä¸Šä¼ çš„æœ¬åœ°æ–‡ä»¶ï¼Œç„¶åç‚¹å‡» **Open**ã€‚
    æ–‡ä»¶å°†åŠ è½½åˆ°æ‚¨çš„ Langflow æœåŠ¡å™¨ã€‚
3. è¦å°†æ•°æ®åŠ è½½åˆ°å‘é‡å­˜å‚¨ä¸­ï¼Œè¯·ç‚¹å‡»å‘é‡å­˜å‚¨ç»„ä»¶ï¼Œç„¶åç‚¹å‡» <Icon name="Play" aria-hidden="true" /> **Run component** ä»¥è¿è¡Œæ‰€é€‰ç»„ä»¶åŠå…¶æ‰€æœ‰å…ˆå‰çš„ä¾èµ–ç»„ä»¶ã€‚

</TabItem>
<TabItem value="API" label="Langflow API">

è¦ä»¥ç¼–ç¨‹æ–¹å¼åŠ è½½æ•°æ®ï¼Œè¯·ä½¿ç”¨ `/v2/files/` å’Œ `/v1/run/$FLOW_ID` ç«¯ç‚¹ã€‚ç¬¬ä¸€ä¸ªç«¯ç‚¹å°†æ–‡ä»¶åŠ è½½åˆ°æ‚¨çš„ Langflow æœåŠ¡å™¨ï¼Œç„¶åè¿”å›ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ã€‚ç¬¬äºŒä¸ªç«¯ç‚¹è¿è¡Œ **Load Data Flow**ï¼Œå¼•ç”¨ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯¹æ•°æ®è¿›è¡Œåˆ†å—ã€åµŒå…¥å¹¶åŠ è½½åˆ°å‘é‡å­˜å‚¨ä¸­ã€‚

ä»¥ä¸‹è„šæœ¬æ¼”ç¤ºäº†æ­¤è¿‡ç¨‹ã€‚
å¦‚éœ€å¸®åŠ©åˆ›å»ºæ­¤è„šæœ¬ï¼Œè¯·ä½¿ç”¨ [Langflow File Upload Utility](https://langflow-file-upload-examples.onrender.com/)ã€‚

```js
// Node 18+ example using global fetch, FormData, and Blob
import fs from 'fs/promises';

// 1. Prepare the form data with the file to upload
const fileBuffer = await fs.readFile('FILE_NAME');
const data = new FormData();
data.append('file', new Blob([fileBuffer]), 'FILE_NAME');
const headers = { 'x-api-key': 'LANGFLOW_API_KEY' };

// 2. Upload the file to Langflow
const uploadRes = await fetch('LANGFLOW_SERVER_ADDRESS/api/v2/files/', {
  method: 'POST',
  headers,
  body: data
});
const uploadData = await uploadRes.json();
const uploadedPath = uploadData.path;

// 3. Call the Langflow run endpoint with the uploaded file path
const payload = {
  input_value: "Analyze this file",
  output_type: "chat",
  input_type: "text",
  tweaks: {
    'FILE_COMPONENT_NAME': {
      path: uploadedPath
    }
  }
};
const runRes = await fetch('LANGFLOW_SERVER_ADDRESS/api/v1/run/FLOW_ID', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json', 'x-api-key': 'LANGFLOW_API_KEY' },
  body: JSON.stringify(payload)
});
const langflowData = await runRes.json();
// Output only the message
console.log(langflowData.outputs?.[0]?.outputs?.[0]?.results?.message?.data?.text);
```

</TabItem>
</Tabs>

å½“ flow è¿è¡Œæ—¶ï¼Œflow ä¼šæ¥æ”¶é€‰å®šçš„æ–‡ä»¶ï¼Œå¯¹æ•°æ®è¿›è¡Œåˆ†å—ï¼Œå°†æ•°æ®åŠ è½½åˆ°å‘é‡å­˜å‚¨æ•°æ®åº“ä¸­ï¼Œç„¶åä¸ºå—ç”ŸæˆåµŒå…¥ï¼Œè¿™äº›åµŒå…¥ä¹Ÿå­˜å‚¨åœ¨å‘é‡å­˜å‚¨ä¸­ã€‚

æ‚¨çš„æ•°æ®åº“ç°åœ¨åŒ…å«å¸¦æœ‰å‘é‡åµŒå…¥çš„æ•°æ®ï¼ŒLLM å¯ä»¥ä½¿ç”¨è¿™äº›æ•°æ®ä½œä¸ºä¸Šä¸‹æ–‡æ¥å“åº”æŸ¥è¯¢ï¼Œå¦‚æ•™ç¨‹çš„ä¸‹ä¸€èŠ‚æ‰€ç¤ºã€‚

## ä» JavaScript åº”ç”¨ç¨‹åºä¸æ‚¨çš„ flow èŠå¤©

è¦ä¸å‘é‡æ•°æ®åº“ä¸­çš„æ•°æ®èŠå¤©ï¼Œè¯·åˆ›å»ºä¸€ä¸ªä»¥ç¼–ç¨‹æ–¹å¼è¿è¡Œ **Retriever Flow** çš„èŠå¤©æœºå™¨äººåº”ç”¨ç¨‹åºã€‚

æœ¬æ•™ç¨‹ä½¿ç”¨ JavaScript ä½œä¸ºæ¼”ç¤ºç›®çš„ã€‚

1. è¦æ„å»ºèŠå¤©æœºå™¨äººï¼Œè¯·æ”¶é›†ä»¥ä¸‹ä¿¡æ¯ï¼š

    * `LANGFLOW_SERVER_ADDRESS`ï¼šæ‚¨çš„ Langflow æœåŠ¡å™¨åŸŸåã€‚é»˜è®¤å€¼æ˜¯ `127.0.0.1:7860`ã€‚æ‚¨å¯ä»¥ä» flow çš„ [**API access** é¢æ¿](/concepts-publish#api-access) ä¸Šçš„ä»£ç ç‰‡æ®µä¸­è·å–æ­¤å€¼ã€‚
    * `FLOW_ID`ï¼šæ‚¨çš„ flow çš„ UUID æˆ–è‡ªå®šä¹‰ç«¯ç‚¹åç§°ã€‚æ‚¨å¯ä»¥ä» flow çš„ [**API access** é¢æ¿](/concepts-publish#api-access) ä¸Šçš„ä»£ç ç‰‡æ®µä¸­è·å–æ­¤å€¼ã€‚
    * `LANGFLOW_API_KEY`ï¼šæœ‰æ•ˆçš„ Langflow API å¯†é’¥ã€‚è¦åˆ›å»º API å¯†é’¥ï¼Œè¯·å‚é˜… [API keys](/configuration-api-keys)ã€‚

2. å°†ä»¥ä¸‹è„šæœ¬å¤åˆ¶åˆ° JavaScript æ–‡ä»¶ä¸­ï¼Œç„¶åç”¨æ‚¨åœ¨ä¸Šä¸€æ­¥ä¸­æ”¶é›†çš„ä¿¡æ¯æ›¿æ¢å ä½ç¬¦ï¼š

    ```js
    const readline = require('readline');
    const { LangflowClient } = require('@datastax/langflow-client');

    const API_KEY = 'LANGFLOW_API_KEY';
    const SERVER = 'LANGFLOW_SERVER_ADDRESS';
    const FLOW_ID = 'FLOW_ID';

    const rl = readline.createInterface({ input: process.stdin, output: process.stdout });

    // Initialize the Langflow client
    const client = new LangflowClient({
        baseUrl: SERVER,
        apiKey: API_KEY
    });

    async function sendMessage(message) {
        try {
            const response = await client.flow(FLOW_ID).run(message, {
                session_id: 'user_1'
            });

            // Use the convenience method to get the chat output text
            return response.chatOutputText() || 'No response';
        } catch (error) {
            return `Error: ${error.message}`;
        }
    }

    function chat() {
        console.log('ğŸ¤– Langflow RAG Chatbot (type "quit" to exit)\n');

        const ask = () => {
            rl.question('ğŸ‘¤ You: ', async (input) => {
                if (['quit', 'exit', 'bye'].includes(input.trim().toLowerCase())) {
                    console.log('ğŸ‘‹ Goodbye!');
                    rl.close();
                    return;
                }

                const response = await sendMessage(input.trim());
                console.log(`ğŸ¤– Assistant: ${response}\n`);
                ask();
            });
        };

        ask();
    }

    chat();
    ```

    è„šæœ¬åˆ›å»ºä¸€ä¸ª Node åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä¸å‘é‡æ•°æ®åº“ä¸­çš„å†…å®¹èŠå¤©ï¼Œä½¿ç”¨ `chat` è¾“å…¥å’Œè¾“å‡ºç±»å‹ä¸æ‚¨çš„ flow é€šä¿¡ã€‚
    èŠå¤©åœ¨å¤šæ¡æ¶ˆæ¯ä¸­ç»´æŠ¤æŒç»­çš„å¯¹è¯ä¸Šä¸‹æ–‡ã€‚å¦‚æœæ‚¨ä½¿ç”¨ `text` ç±»å‹çš„è¾“å…¥å’Œè¾“å‡ºï¼Œæ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡æœ¬å­—ç¬¦ä¸²ã€‚

    :::tip
    [Langflow TypeScript å®¢æˆ·ç«¯](/typescript-client) æœ‰ä¸€ä¸ª `chatOutputText()` ä¾¿åˆ©æ–¹æ³•ï¼Œå¯ç®€åŒ–å¤„ç† Langflow å¤æ‚ JSON å“åº”ç»“æ„çš„å·¥ä½œã€‚
    è¯¥å®¢æˆ·ç«¯ä¸éœ€è¦æ‰‹åŠ¨å¯¼èˆªé€šè¿‡å¤šå±‚åµŒå¥—å¯¹è±¡ `data.outputs[0].outputs[0].results.message.data.text`ï¼Œè€Œæ˜¯è‡ªåŠ¨æå–æ¶ˆæ¯æ–‡æœ¬å¹¶ä¼˜é›…åœ°å¤„ç†å¯èƒ½æœªå®šä¹‰çš„å€¼ã€‚
    :::

3. ä¿å­˜å¹¶è¿è¡Œè„šæœ¬ä»¥å‘é€è¯·æ±‚å¹¶æµ‹è¯• flowã€‚

    <details>
    <summary>ç»“æœ</summary>

    ä»¥ä¸‹æ˜¯æœ¬æ•™ç¨‹ flow çš„ç¤ºä¾‹å“åº”ã€‚ç”±äº LLM çš„æ€§è´¨å’Œæ‚¨è¾“å…¥çš„å˜åŒ–ï¼Œæ‚¨çš„å“åº”å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚

    ```
    ğŸ‘¤ You: Do you have any documents about engines?
    ğŸ¤– Assistant: Yes, the provided text contains several warnings and guidelines related to engine installation, maintenance, and selection. It emphasizes the importance of using the correct engine for specific applications, ensuring all components are in good condition, and following safety precautions to prevent fire or explosion. If you need more specific information or details, please let me know!

    ğŸ‘¤ You: It should be about a Briggs and Stratton engine.
    ğŸ¤– Assistant: The text provides important safety and installation guidelines for Briggs & Stratton engines. It emphasizes that these engines should not be used on 3-wheel All-Terrain Vehicles (ATVs), motor bikes, aircraft products, or vehicles intended for competitive events, as such uses are not approved by Briggs & Stratton.

    If you have any specific questions about Briggs & Stratton engines or need further information, feel free to ask!
    ```

    </details>

## ä¸‹ä¸€æ­¥

æœ‰å…³æ„å»ºæˆ–æ‰©å±•æœ¬æ•™ç¨‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä»¥ä¸‹å†…å®¹ï¼š

* [Model Context Protocol (MCP) servers](/mcp-server)
* [Langflow deployment overview](/deployment-overview)