---
title: 记忆聊天机器人
slug: /memory-chatbot
---

import Icon from "@site/src/components/icon";

:::info
**聊天记忆**组件也被称为**消息历史**组件。
:::

该流程在[基础提示流程](/basic-prompting)的基础上添加了[消息历史](/components-helpers#message-history)组件，用于存储之前的聊天消息并将其用作当前对话的上下文。

## 前提条件

- [运行中的 Langflow 实例](/get-started-installation)
- [OpenAI API 密钥](https://platform.openai.com/)

## 创建记忆聊天机器人流程

1. 在 Langflow 仪表板中，点击**新建流程**。
2. 选择**记忆聊天机器人**。
3. **记忆聊天机器人**流程已创建。

![Memory chatbot flow](/img/starter-flow-memory-chatbot.png)

该流程在基础提示流程中添加了**消息历史**组件。
该组件检索之前的消息并将其发送到**提示**组件，用上下文填充**模板**的一部分。

要查看模板，请点击**提示**组件中的**模板**字段。
**提示**指导**语言模型**组件如何响应输入。

```text
You are a helpful assistant that answers questions.

Use markdown to format your answer, properly embedding images and urls.

History:

{memory}
```

提示中的 `{memory}` 代码在组件中创建了一个名为 **memory** 的新输入端口。
**消息历史**组件连接到此端口，用于存储来自**游乐场**的聊天消息，并为**语言模型**组件提供之前聊天消息的记忆。

## 运行记忆聊天机器人流程

1. 打开**游乐场**。
2. 输入多个问题。例如，尝试输入以下对话：

```text
Hi, my name is Luca.
Please tell me about PostgreSQL.
What is my name?
What is the second subject I asked you about?
```

聊天机器人会记住您的姓名和之前的问题。

3. 要查看**消息日志**面板，在**游乐场**面板中，点击 <Icon name="Ellipsis" aria-hidden="true"/> **选项**，然后点击**消息日志**。
**消息日志**面板显示所有之前的消息。

![Message logs pane](/img/messages-logs.png)

## 在记忆聊天机器人流程中使用会话 ID

`session_id` 是 Langflow 中用于存储 AI 与用户之间对话会话的唯一标识符。当对话开始时会创建一个 `session_id`，然后与该会话期间的所有后续消息关联。

在您创建的**记忆聊天机器人**流程中，**消息历史**组件通过**会话 ID** 引用过去的交互。您可以通过修改**会话 ID** 值来在不同的对话历史之间切换，以演示此功能。

1. 在**消息历史**和**聊天输入**组件的**会话 ID** 字段中，添加一个**会话 ID** 值，如 `MySessionID`。
2. 现在，一旦您在**游乐场**中发送新消息，您应该会在**消息日志**面板中看到创建了新会话。
3. 注意您的对话是如何存储在不同的记忆会话中的。

要了解更多关于 Langflow 中记忆功能的信息，请参阅[记忆](/memory)。