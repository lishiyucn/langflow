---
title: Vertex AI
slug: /bundles-vertexai
---

import Icon from "@site/src/components/icon";

[组件包](/components-bundle-components)包含支持与 Langflow 特定第三方集成的自定义组件。

本页介绍了 **Vertex AI** 组件包中可用的组件。

有关 Vertex AI 组件所使用的 Vertex AI 功能和特性的更多信息，请参阅 [Vertex AI 文档](https://cloud.google.com/vertex-ai)。

有关其他 Google 组件，请参阅 [**Google** 组件包](/bundles-google)。

## Vertex AI 文本生成

**Vertex AI** 组件使用 Google Vertex AI 模型生成文本。

它可以输出**模型响应** ([`Message`](/data-types#message)) 或**语言模型** ([`LanguageModel`](/data-types#languagemodel))。

当您想要将 Vertex AI 模型用作另一个LLM驱动组件（如**语言模型**或**智能函数**组件）的 LLM 时，请使用**语言模型**输出。

有关更多信息，请参阅[**语言模型**组件](/components-models)。

### Vertex AI 文本生成参数

许多 **Vertex AI** 组件输入参数在可视化编辑器中默认是隐藏的。
您可以通过[组件标题菜单](/concepts-components#component-menus)中的 <Icon name="SlidersHorizontal" aria-hidden="true"/> **控制** 来切换参数。

| 名称 | 类型 | 描述 |
|------|------|-------------|
| credentials | File | 输入参数。JSON 凭据文件。留空以回退到环境变量。文件类型：JSON。有关更多信息，请参阅[为 Vertex AI 身份验证创建服务账户](#vertexai-credentials)。 |
| model_name | String | 输入参数。要使用的 Vertex AI 模型名称。默认值："gemini-1.5-pro"。 |
| project | String | 输入参数。项目 ID（高级选项）。 |
| location | String | 输入参数。Vertex AI API 的位置。默认值："us-central1"（高级选项）。 |
| max_output_tokens | Integer | 输入参数。要生成的最大令牌数（高级选项）。 |
| max_retries | Integer | 输入参数。API 调用的最大重试次数。默认值：1（高级选项）。 |
| temperature | Float | 输入参数。控制输出的随机性。默认值：0.0。 |
| top_k | Integer | 输入参数。为 top-k 过滤保留的最高概率词汇令牌数（高级选项）。 |
| top_p | Float | 输入参数。为核采样保留的所有最高概率词汇令牌的累积概率。默认值：0.95（高级选项）。 |
| verbose | Boolean | 输入参数。是否打印详细输出。默认值：False（高级选项）。 |

有关 Vertex AI 文本生成参数的更多信息，请参阅 [Vertex AI 内容生成参数文档](https://cloud.google.com/vertex-ai/generative-ai/docs/multimodal/content-generation-parameters#token-sampling-parameters)。

## Vertex AI Embeddings

**Vertex AI Embeddings** 组件是 [Google Vertex AI Embeddings API](https://cloud.google.com/vertex-ai/docs/generative-ai/embeddings/get-text-embeddings) 的包装器，用于嵌入生成。

有关在流程中使用嵌入模型组件的更多信息，请参阅[**嵌入模型**组件](/components-embedding-models)。

### Vertex AI Embeddings 参数

许多 **Vertex AI Embeddings** 组件输入参数在可视化编辑器中默认是隐藏的。
您可以通过[组件标题菜单](/concepts-components#component-menus)中的 <Icon name="SlidersHorizontal" aria-hidden="true"/> **控制** 来切换参数。

| 名称 | 类型 | 描述 |
|------|------|-------------|
| credentials | Credentials | 输入参数。JSON 凭据文件。留空以回退到环境变量。文件类型：JSON。有关更多信息，请参阅[为 Vertex AI 身份验证创建服务账户](#vertexai-credentials)。 |
| location | String | 输入参数。进行 API 调用时使用的默认位置。默认值：`us-central1`。 |
| max_output_tokens | Integer | 输入参数。令牌限制决定了一个提示的最大文本输出量。默认值：`128`。 |
| model_name | String | 输入参数。Vertex AI 大语言模型的名称。默认值：`text-bison`。 |
| project | String | 输入参数。进行 Vertex API 调用时使用的默认 GCP 项目。 |
| request_parallelism | Integer | 输入参数。对 Vertex AI 模型发出请求允许的并行性量。默认值：`5`。 |
| temperature | Float | 输入参数。调节文本生成中的随机性程度。应为非负值。默认值：`0`。 |
| top_k | Integer | 输入参数。模型如何为输出选择令牌。下一个令牌从最高的 `k` 个令牌中选择。默认值：`40`。 |
| top_p | Float | 输入参数。令牌从最可能到最不可能选择，直到它们的概率总和超过 top `p` 值。默认值：`0.95`。 |
| tuned_model_name | String | 输入参数。调优模型的名称。如果提供，则忽略 `model_name`。 |
| verbose | Boolean | 输入参数。该参数控制输出中的详细程度。设置为 `True` 时，它会打印链的内部状态以帮助调试。默认值：`False`。 |
| embeddings | Embeddings | 输出参数。使用 Vertex AI 生成嵌入的实例。 |

## 为 Vertex AI 身份验证创建服务账户 {#vertexai-credentials}

**Vertex AI Embeddings** 和 **Vertex AI** 组件使用服务账户 JSON 文件与 [Google Vertex AI API](https://console.cloud.google.com/marketplace/product/google/aiplatform.googleapis.com) 进行身份验证。

这些组件要求您在 **Credentials** 参数 (`credentials`) 中提供服务账户 JSON 文件。
您可以直接在组件设置中提供文件，或者使用 [`GOOGLE_APPLICATION_CREDENTIALS` 环境变量](https://cloud.google.com/docs/authentication/application-default-credentials) 来引用您的 JSON 文件路径。

以下步骤解释如何为 Langflow 创建服务账户、创建服务账户 JSON 密钥文件，然后在 Langflow 中使用 JSON 密钥文件：

1. 如果您还没有这样做，请[在您的 Google Cloud 项目中启用 Vertex AI API](https://cloud.google.com/vertex-ai/docs/start/cloud-environment)。

2. 在您的 Google Cloud 项目中创建一个[服务账户](https://cloud.google.com/iam/docs/service-account-overview)。

    建议您[为 Vertex AI 创建自定义服务账户](https://cloud.google.com/vertex-ai/docs/general/custom-service-account)，因为 Langflow 使用此账户访问 Vertex AI API。

3. 将 **Vertex AI Service Agent** 角色分配给服务账户。

    此角色允许 Langflow 访问 Vertex AI 资源。
    有关更多信息，请参阅 [使用 IAM 进行 Vertex AI 访问控制](https://cloud.google.com/vertex-ai/docs/general/access-control)。

4. 为您的 Langflow Vertex AI 服务账户[创建 JSON 格式的服务账户密钥](https://cloud.google.com/iam/docs/keys-create-delete#console)。

    当您点击**创建**时，JSON 密钥文件将被下载。

5. 在 Langflow 中，创建或打开包含 **Vertex AI** 或 **Vertex AI Embeddings** 组件的流程。

6. 在组件的 **Credentials** 字段中，执行以下操作之一：

    * 直接选择您的服务账户 JSON 文件。

    * 如果您想从环境变量中拉取密钥文件，请将 **Credentials** 字段留空。
    然后，您必须在相对于您的 Langflow 实例设置的 `GOOGLE_APPLICATION_CREDENTIALS` 环境变量中提供 JSON 文件的路径。
    例如，您可以在终端、Langflow `.env` 文件中设置环境变量，或在 Langflow 服务器或应用程序运行的环境中设置。

    ![Select a local JSON key file for the Vertex AI component](/img/google/configure-vertex-ai-credentials-in-langflow.gif)

7. 运行您的流程以验证 Langflow 可以成功使用服务账户凭据。

    例如，在包含 **Chat Input**、**Chat Output** 和 **Vertex AI** 组件的流程中，您可以打开 **Playground** 并尝试与 LLM 聊天。
    如果 LLM 响应，则凭据配置正确。